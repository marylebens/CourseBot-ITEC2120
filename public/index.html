<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CourseBot - Dr. Mary's Assistant</title>
</head>
<body style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh;">
  
  <div style="max-width: 700px; margin: auto; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); overflow: hidden;">
    
    <!-- Header -->
    <div style="background: linear-gradient(45deg, #333, #555); color: white; padding: 20px; text-align: center;">
      <h1 style="margin: 0; font-size: 24px; font-weight: 300;">CourseBot</h1>
      <p style="margin: 5px 0 0 0; opacity: 0.9; font-size: 14px;">Dr. Mary's Course Assistant</p>
    </div>
    
    <!-- Chat Messages -->
    <div id="messages" style="height: 450px; overflow-y: auto; padding: 20px; background: #fafafa; scrollbar-width: thin;">
      <div style="text-align: center; color: #666; margin-bottom: 20px; font-style: italic;">
        Hi! I'm CourseBot, and I'm here to help you with ITEC2120. Ask me a question about the course or about databases! ðŸ™‚
      </div>
    </div>
    
    <!-- Input Area -->
    <div style="padding: 20px; background: white; border-top: 1px solid #eee; display: flex; gap: 10px;">
      <input 
        type="text" 
        id="input" 
        placeholder="Type your question here..." 
        style="flex: 1; padding: 12px 15px; border: 2px solid #ddd; border-radius: 25px; font-size: 14px; outline: none; transition: all 0.3s ease;"
        onkeypress="if(event.key==='Enter') send()"
        onfocus="this.style.borderColor='#667eea'"
        onblur="this.style.borderColor='#ddd'"
      />
      <button 
        onclick="send()" 
        style="padding: 12px 25px; background: linear-gradient(45deg, #667eea, #764ba2); color: white; border: none; border-radius: 25px; cursor: pointer; font-weight: 500; transition: all 0.3s ease; box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);"
        onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 15px rgba(102, 126, 234, 0.4)'"
        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 10px rgba(102, 126, 234, 0.3)'"
      >
        Send
      </button>
    </div>
        <!-- AI Disclaimer -->
    <div style="background: #f8f9fa; padding: 15px 20px; border-top: 1px solid #dee2e6; font-size: 12px; color: #6c757d; line-height: 1.4;">
      <strong style="color: #495057;">AI Disclaimer:</strong> CourseBot is a custom tool designed and built by Dr. Mary Lebens. It uses GPT-4o-mini to search course materials and help you find information quickly. While helpful, AI responses may be incomplete or imperfect. Always verify important information by checking the original course materials yourself.
    </div>
  </div>

  </div>

  <script>
    async function send() {
      const input = document.getElementById("input");
      const messages = document.getElementById("messages");
      const userText = input.value.trim();
      
      if (!userText) return;
      
      // Add user message
      messages.innerHTML += `
        <div style="margin-bottom: 15px; display: flex; justify-content: flex-end;">
          <div style="background: linear-gradient(45deg, #667eea, #764ba2); color: white; padding: 12px 18px; border-radius: 20px 20px 5px 20px; max-width: 70%; word-wrap: break-word; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
            ${userText}
          </div>
        </div>
      `;
      
      input.value = "";
      messages.scrollTop = messages.scrollHeight;
      
      // Show typing indicator
      const typingId = Date.now();
      messages.innerHTML += `
        <div id="typing-${typingId}" style="margin-bottom: 15px; display: flex; justify-content: flex-start;">
          <div style="background: #e9ecef; color: #666; padding: 12px 18px; border-radius: 20px 20px 20px 5px; font-style: italic;">
            CourseBot is typing...
          </div>
        </div>
      `;
      messages.scrollTop = messages.scrollHeight;
      
      try {
        const res = await fetch("/api/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: userText })
        });
        const data = await res.json();
        
        // Remove typing indicator
        document.getElementById(`typing-${typingId}`).remove();
        
        // Add bot response
        messages.innerHTML += `
          <div style="margin-bottom: 15px; display: flex; justify-content: flex-start;">
            <div style="background: #e9ecef; color: #333; padding: 12px 18px; border-radius: 20px 20px 20px 5px; max-width: 70%; word-wrap: break-word; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
              ${data.reply}
            </div>
          </div>
        `;
      } catch (error) {
        // Remove typing indicator and show error
        document.getElementById(`typing-${typingId}`).remove();
        messages.innerHTML += `
          <div style="margin-bottom: 15px; display: flex; justify-content: flex-start;">
            <div style="background: #f8d7da; color: #721c24; padding: 12px 18px; border-radius: 20px 20px 20px 5px; max-width: 70%; word-wrap: break-word; border: 1px solid #f5c6cb;">
              Sorry, I'm having trouble connecting right now. Please try again.
            </div>
          </div>
        `;
      }
      
      messages.scrollTop = messages.scrollHeight;
    }
    
    // Focus input on load
    document.getElementById("input").focus();
  </script>
</body>
</html>
